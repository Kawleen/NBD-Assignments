MATCH paths = (origin:Airport { name:"LAX" })<-[r:ORIGIN|DESTINATION*0..]->(destination:Airport{name:"DAY" }) WHERE ALL(n IN NODES(paths)  WHERE  SINGLE(nonDuplicatedNode IN NODES(paths)   WHERE  n=nonDuplicatedNode )) AND ALL(notRepeatLastRelationship IN RELATIONSHIPS(paths)  WHERE  TYPE(notRepeatLastRelationship)<>TYPE( RELATIONSHIPS(paths)[[i IN RANGE(0, SIZE(RELATIONSHIPS(paths))-1) WHERE RELATIONSHIPS(paths)[i] = notRepeatLastRelationship][0]-1] ))
WITH  MIN(REDUCE(total = 0, n IN [x IN NODES(paths)  WHERE  'Flight' IN LABELS(x)] |  total + [(n)<-[:ASSIGN]-(ticket{class:"business"}) | ticket.price][0])) AS totalPrice 
MATCH path=  (origin:Airport { name:"LAX" })<-[r:ORIGIN|DESTINATION*4..10]->(destination:Airport{name:"DAY" })  WHERE   ALL(n IN NODES(path)  WHERE  SINGLE(nonDuplicatedNode IN NODES(path)   WHERE  n=nonDuplicatedNode )) AND ALL(notRepeatLastRelationship IN RELATIONSHIPS(paths)  WHERE  TYPE(notRepeatLastRelationship)<>TYPE( RELATIONSHIPS(paths)[[i IN RANGE(0, SIZE(RELATIONSHIPS(paths))-1) WHERE RELATIONSHIPS(paths)[i] = notRepeatLastRelationship][0]-1] ))
AND REDUCE(total = 0, n IN [x IN NODES(path)  WHERE  'Flight' IN LABELS(x)] |  total + [(n)<-[:ASSIGN]-(ticket{class:"business"}) | ticket.price][0]) =totalPrice
RETURN  path,totalPrice
